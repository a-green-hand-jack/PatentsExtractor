# Patents_Extractor - 项目初始化协作文档

**目标**: 本文档旨在通过与 AI 助手的协作讨论，明确项目 `Patents_Extractor` 的核心需求、技术方案和实施计划，最终形成一份完整的项目启动说明。

---

## 1. 项目概述 (Overall Vision)

- **项目名称**: `Patents_Extractor`
- **一句话描述**: `一个基于多Agent系统的专利信息智能提取工具，用户提供PDF文件或网页链接，通过多轮对话完善问题描述，最终返回符合模板要求的答案`
- **最终交付物**: `一个可以通过 uv run 调用的命令行工具，支持PDF文件和网页链接输入，提供Markdown和JSON两种输出格式`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户明确了项目核心：1) 单专利处理，不支持批量处理 2) 多轮对话完善问题描述 3) Agent在会话开始时引导用户规范化输入 4) 优先处理Google Patents网页链接 5) 采用多Agent系统架构（结构化Agent、问答Agent、输出Agent）

---

## 2. 详细需求 (Detailed Requirements)

### 2.1. 输入处理 (Input Handling)
- **需求描述**: `支持两种输入方式：1) PDF文件（OCR和标准PDF分别处理）2) 专利网页链接（优先Google Patents）。需要处理表格、图片、蛋白质序列等复杂内容，使用多种方法确保抓取成功率`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户简化了输入要求：不支持专利编号查询，专注于PDF文件和网页链接。强调使用多种方法保证网页抓取和PDF解析的成功率，如果失败则报错让用户更换专利。

### 2.2. 核心功能 (Core Functionality)
- **需求描述**: `多Agent系统架构：1) 结构化Agent：将非结构化数据转换为markdown/json格式，便于LLM读取 2) 问答Agent：使用RAG技术处理长文档，回答用户问题 3) 输出Agent：生成符合模板要求的结构化输出。支持多轮对话完善问题描述`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户明确了多Agent系统架构：结构化Agent负责数据转换，问答Agent负责问题回答，输出Agent负责格式化输出。强调多轮对话能力，Agent需要引导用户规范化输入。

### 2.3. 输出格式 (Output Format)
- **需求描述**: `提供Markdown和JSON两种输出格式，确保内容一致性。Markdown便于用户阅读，JSON便于LLM处理。支持内置模板和用户自定义模板，保证输出的可重复性`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户强调输出格式的双重性：Markdown用于用户阅读，JSON用于LLM处理。两种格式必须保证内容一致性，支持模板系统确保可重复性。

---

## 3. 技术选型 (Technical Stack)

- **技术栈描述**: `Python + uv + LangGraph + Qwen2.5-VL(多模态) + Qwen2.5-Max(语言模型) + BeautifulSoup(网页解析) + PyMuPDF(PDF处理) + Chroma(向量数据库) + Jinja2(模板引擎) + 基于LLM的OCR`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户强调技术选型以稳定为第一要务，选择广为使用、资源丰富的技术。明确使用Qwen家族最好的模型（Qwen2.5-VL用于多模态，Qwen2.5-Max用于语言处理），优先使用基于LLM的OCR方法。

---

## 4. 架构与设计 (Architecture & Design)

### 4.1. 项目结构 (Project Structure)
- **设计要求**: `遵循Python标准化项目结构，使用src布局，分离核心业务逻辑、数据处理、Agent管理、模板系统等模块`
- **状态**: `[x] 待讨论` `[ ] 讨论中` `[ ] 已确认`

### 讨论记录:
> 需要设计清晰的模块分离，确保各功能模块的独立性和可测试性。

### 4.2. 关键设计决策 (Key Design Decisions)
- **决策点**: `1) 使用LangGraph构建多Agent系统 2) 采用Chroma作为向量数据库 3) 使用Qwen2.5-VL处理多模态内容 4) 基于Jinja2的模板系统 5) Agent间通过状态管理实现协作`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户明确了关键决策：使用LangGraph构建多Agent系统，Qwen2.5-VL处理多模态，Chroma作为向量数据库。强调Agent间的协作和状态管理。

---

## 5. 文档与测试 (Documentation & Testing)

- **要求描述**: `文档简洁明了，通过示例说明各模块功能，避免技术细节。测试分级进行：单元测试（各Agent功能）、集成测试（Agent协作）、端到端测试（完整流程）`
- **状态**: `[x] 待讨论` `[x] 讨论中` `[ ] 已确认`

### 讨论记录:
> 用户强调文档要简洁，通过例子说明功能，不要介绍技术细节。测试要分级，确保每个模块都能正确使用。

---

## 6. 总结与下一步 (Summary & Next Steps)

- **项目初始化确认**: `[x] 所有章节已确认`
- **下一步计划**: `开始搭建项目脚手架，实现多Agent系统的基础架构`

### 讨论记录:
> 基于用户详细反馈，项目需求已经明确：多Agent系统架构（结构化Agent、问答Agent、输出Agent），使用Qwen2.5系列模型，支持PDF和网页链接输入，提供Markdown和JSON双格式输出。技术选型以稳定为优先，文档简洁实用，测试分级进行。

---

## 7. 补充考虑的问题 (Additional Considerations)

基于用户需求和项目复杂性，我建议补充讨论以下问题：

### 7.1. 性能与扩展性
- **问题**: 单专利处理，性能需求较低，无需考虑分布式处理
- **状态**: `[x] 待讨论` `[x] 讨论中` `[x] 已确认`

### 7.2. 错误处理与容错
- **问题**: 使用多种方法保证网页抓取和PDF解析成功率，优先使用基于LLM的OCR，失败时报错让用户更换专利
- **状态**: `[x] 待讨论` `[x] 讨论中` `[x] 已确认`

### 7.3. 数据安全与隐私
- **问题**: 专利数据公开，暂不考虑数据安全问题
- **状态**: `[x] 待讨论` `[x] 讨论中` `[x] 已确认`

### 7.4. 模型选择与优化
- **问题**: 使用Qwen家族最好的模型（Qwen2.5-VL用于多模态，Qwen2.5-Max用于语言处理）
- **状态**: `[x] 待讨论` `[x] 讨论中` `[x] 已确认`

### 7.5. 用户体验
- **问题**: 优先实现核心功能，通过命令行与Agent交互。如果LangGraph有现成的Web界面可以考虑使用
- **状态**: `[x] 待讨论` `[x] 讨论中` `[x] 已确认`

### 讨论记录:
> 用户明确了补充问题的处理方式：性能要求低，错误处理要健壮，数据安全暂不考虑，使用最好的Qwen模型，用户体验优先命令行交互。
